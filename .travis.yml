language: node_js
node_js:
- lts/*
stages:
- test
- name: build
  if: branch = develop
- name: deploy
  if: branch = master
jobs:
  include:
  - stage: test
    script: yarn test:unit
  - stage: build
    script: yarn build
  - stage: deploy
    script: "./deploy.sh"
env:
  global:
  - secure: Vva68dK0tnJCAYV65mKIFj8Yr3mvqBm8ZZwL9JQ7OA5Ra3+pogdZgoC/Ad01PDB61SaJPti7iZhLxmWgtciy1Q5/Er0jdwDTB4/S03wHFpZCbE33YCm1Xk+VsgBIh+bMmkJTnzJSZNxPrLWbkgtWolFG37fpdlh4v7TkswcFIGhxguzJ4avsmBMVsOOr4LjQwqyXAxQ8osuN6PftvWLcYZKqfRAEYoz5bZPRT5rbt01O5cOx5Kamc9+TjFIsRdME/Pj/z2P/2acVp79nqe/6fLYuzUu5EjFIx9U0E0jhZkoCbl6B0nKelvFx+taNCu8Sm+Aq8ayUA60IvMoV7WgEok5OYh6KHoST12qqb9elTS6+8pNkVENm8OAh2ODqROumX9huL584R/kt3zJV22e/HMuTvDY9PtA8CT3L9LhGyqejz2rsfMnfcaAFaKp5rWHDIJN0oRy75agotRzhmp00T58Ks0pa9Pwl/YzILOc+nam4saYcS7u5Sfetd96AZzm0nsfend9NnQjSWEWgEHxlA8I7nmnw2y/X4Fs0q7lI+cy2U5/qwNH7H6dYPWN9pAFqz6xMy8TehN1Wn1If1AplikgHWIsSbuxab0nzzhfthcIKmSZ9Puo3j+76c7yvvYYroS/C50l8P7C8bATMlwqNN3yQVy31291nnQGUZ7LZdbA=
  - secure: dxpE+DZVaT+1yMgGuWE/PWP6M/3YJa3m0lKAfgdQi0vD8npevJ31tLA8MDhMzF/0GbJbGLZzdWKrK3Clom5dFO2+bPWcFHIGAvStM0bkmewCaTzF428escQse8MNceHxc6M2wtetNqVN8mbbqBVHyoGVtVF/hBpmbRvTLx7TQB/mcndFKpFfmSSmN0c3Ee1mEjJlGf4A8BpnGdPlxQP5lFuBV1T7hpOjskcoXgZFv+W6PcsoioAGu+JgKw1I6z9bervTIZ4D+p6iDXpMTBY1njACxNeXbaPijodQUtNFNTX58ymYK62FMQkXvQGjDBrqGuWthKsF5pHhQdwkhL/Tv14LZNF0X1NKnpksfRV8CdTGd+16hfJQTG998Q3qXh07Qb6fFjTeKGtwlrPhhaZyUjOK3bsf0l6v73riG5V0t6fYpK7XR3jVV4p9y2cN+JO5kvveP2QGiQU1dNSen5T69rh1lztkknAVDklegoPRVQdOwk+CJ3MrvTfnZdDJ8Eww8xxJtRzSOQP/qnzYtAcd8APUwS5wOi4+S6BuJu+ml51dkbHmcB5SuzeRiwM8qP2JpeMGMYiXicuNyJleI3blsq+nz86myHD+4xOfSuc0U2aOh2zfHJYqGXkQT329/JPFReYjyTXY+JswAE9ZDFwn/0JK7l/aAtkafx5TxE1ixmk=
  - secure: QxIYRsS0Ftb7qJ9CbU9WWsD14cCerDKtDt9QFIsl/GjRSN1H5R+r1KKAKsNVF+ryC7rFm3xwIlgQeL17TvVr/ymM5bASo1yr4em07Z3hGgrF3vPwW6IB2Z3gkiRoFXTVGca2YdrS8mAOFXjDbgcvt9Y2k5UtFxGQShG9kuEAj8zOGo6OcFibJC/gobZzgHKAA23oPQRSHymLsCj4kErEaUbiH9Eaou5+g+VuzfmSbp++hXSvRjeFDw2JL1rGjXJuyNVkd+rhdNPyGIL0HTtfPQ3crD+3Rz48lysM2jTmjWSdiVnKZz0JN1Po9Y8m7pAUGp9fEkXUCwpMxB5+BBzPR1ql3aQaQtqXQnzy5Hydba8vg3icgKmxftQGNiC+rdEvwWiel4bPprB1EMM4rxOR9uFXuPtkyH0XJB/ZTbOF7mh5KaukQk4QX8VmOEudRdD7TQfEAit54KAdO+voM1hbe5W+fbwTK9IOUzmwCZ9e+iQtjoyg0dYtOIN+pUe1LvFR86rE26iU9a3ZbhKI3ORCZuCsWifsKISnCI8EKoe+VN7fFGICgUaaqiRxMw1MUiCaeszgnU077R3Xrq00QKVU/y/alqMMlCEfZErOtJOWgR6ywVXBrNL9FpzrOoDIgolH37MbOT0RW/o5SaFazFBiGhcISSJZm146nRgMxVaRSEo=
  - secure: Q5PV76VtlNP6cC3DkQzAKmFcmQLhyexjvjtLSv7A1JZ/Nm3BC00v5loLuK+UXmxNr/T7UIlQyxjxV34kuuh0GrpsiXzpqbk62HuwiPYBbhkTFA48P26ojHnZ1ugCE2SOCH0C9SJCv5rLTj0/rsTg6qwDxIH1eth2b1TkvMKC51/9dEWFqsb7N35zh8vkSd3IMycMr+mYwvQZd0vnkY4A5kl4AoV1+sJRbINJB2CzbGhsOhuKCnPf97BUljCjY4AdkwxtIc8LzkXGSWUFYujz2G9acmInZJCkY1xYIRN7JwMRybNgvmF9WRJ8xm/ocyi0pMvMCNlmwl8gPoL/GFftW6tCSsE5NMC8nWUccVfm1KG5Eyzsi+5TQXxszZ1HWOZNMP3i2hokNhptSOE+tKNW1A/tTqQyR8uOMEEuD7dpFmP9HFuTEw+2+EQ/tV6x3AWPyGEqo9f0Yhy56LBWL90ey1vg9RerYKnjXC3ZNuK550ISlNgQfp8NJWFL96G/lwAzMdCx5xNa9XTy9VDtieElGOebOyfUdBva8HKiHmJ7hqrqZPEnIRsD9Nnq1U3697pAjLrROxgqp38BdUrf4eYi2gWMVccvfdgfhzXYSuiulvRk0wnPbLwO56/D8H/Qw+zi5xdP0Ch6UmMRnqwXzvlKvw1mEKSs2ClQ3AekbfQDbf8=
  - secure: uMJlFtjhpunJFB8qwYCqFOjAAJm//0LMwJe01OjXJHVHUAvgDu+qZLY9QMj2TROk3pf06EHLfoOqT31QvS+trR/hjC/Lf6Ox1NF5a9vSxiECw9Qs+7q2B8gERQtDSNQ9uTypQt0PqoF4Kv6fMPK0f1VfjvBI9VzOYZz4qh2e5XmEXGD/Jvacax05ZPtPHy9P4yxrN93xzH4s/9GK62Xd2d/0uOb4NmsmUPt4LwM49ZgMPeN95h7hKVbh6lQJ8vpYHTJ4EhiG9GKCA9zQ2Ywh/dlydrhtGV0Qr/fo6wgsJoWU6CnB9iYpUb5sl3lJfuH7PYyydnHL+TBUDBMJCAyfBnVrFyvctxe3uk4y6ldwlTZJZto9b1O8UIEbrGqQunVixVXbHs7eXVTFvBTrynxoz8BQ1GVaXtkraNJGld4m7Fpg/P/1iAi+Xtz993AH5qvxX5E2PtDNIvitRgRSCDZzsRXkQCcVrVHwVEL9DRpMD9PQjycF43vyMuoRGGyka+OjEFAnpthIKZ6BZfD0EOkJ9Osid4H4yP7NylmUhWkBlueavDiCp4XMeymsldBCAEecrgVSV1P/NKqjx0kOTW+0d9IxL92hFRaoxo7d6Bca01etC7pxZ7PudKVdBU5SJaqYJ8nAAJlUdpGx8LGLowWzDNQ/euJa9dW6LnYvI8Ts6FM=
  - secure: Em5VAvy0dAS6BTfh7eWY5hMbOU31KdFRkCImLqonXbjy9ycjOxAUAOLeCTxdDRJoQzc0QDFtMn23ifOuCRzC1UEAzF53IxG0zSjIuErbdf2ejJWIQq7Wh7dL5XdeWk8LPLY1we25FKDSNulocjF4S+7lkskItoqJEUE2U/cYeJ73DBadABFZ12rG1T3AXRkDl/eMagzftZvkQqvTpzgS7hzEMtQ2txcamcqImREN2iGbvvGEf+lbXxTsaBX2yBbjTvs3bi/rZ45Qkzns/UvupOTwGO3J0D7U8fST5f6yC/LON4HJFTW1qDn6jSCjmmgiLCMHSkj/m+09q6ydGGIZ2CbLLK+jR3Khc6qpg4fKS2W04pHKH8LDF7SRwr43NVqDzNpeIWcyL5Qffh4Y7s9n7aTNqJogcAwMUjiZZ5xQcSPNp8QyDUkHyqBtYZN1Bdatatzy51sbrv3Vc8Mi9jtB/ldgjPumCUudeYUrLfXI6Tlklcp9yncweLk5qizHHclqvmek52LIOpgVmK4V5UBTqTSpv3eY3Ea/6kGh1jTg01GqfCJLUU8jPJ5IXoODnFaNDqbfd41qf+jBjY8lx94hb2CcfNUnOCHrAuKvqHCILu6RB2tbtEgm00xL5dZWJW7HftMlX+lsBgIsUf5GtkpbqrwzkX6Ulz4NzfU0a6NQT7Q=
  - secure: P/CstaiWW7hbZ12yCd8bmZsiQVzwxgRo1/mut0iVM3yZswJtMLz+Y3fE/iyBCvjYgeayKwo3ZchlIozldbh8nSPF4RflChUmO20MlhtRdOjvETs1kT7RFw6OXd4N1ropJ06xoCFDX82UtpbN1LK2H/YsYkIpesL8uYGMjmrZk3OJcMx0LIjJ3Wc+X0qZjMwOwa4wMXOenlXotdRcLq3+fNee7ukpWjcFPshU9f3pICLCObkdR7sRXU1EP5RUK5k7nEvvx3cTeF7ytNcSpp0564Bt8P9a2IgdASon3uCRYCnTnc9Lq/MIavW3twFXig7xJJmspwlhF6+wRuuQVT8VSNjZ+On7yAvUEPdnAVrqSnapRbx5QKXGYbtprDdOVjxVp8g5eByo9vNyA55X0jt2wj28/EKmypMRgJia/hiszxEdFmxCUVcR+xio1/1Av1N6lszcnaktleQSnCJgD0kFh8zZzaDrRMI4+/0nicdM7EviwEnyUmMcEL4zFzrQcCYlybOej0ieSiA0NbdrzheXn5cY6rqpFWO4Svc22FS5wzdSdp4bJjpPBfKBS5loShqzr/5LgCgcz6at27YOxZ57xeCgv386nADjuYLAU7RWu4uW6p0A9tk2BRYtglJd46mzX0UYEsq/B8zXhhND2mFL7D4OHiZWMwiOiTP36wujaD8=
before_install:
- chmod +x deploy.sh
addons:
  ssh_known_hosts: 51.75.74.29:60000
